const _0x587275=_0x28cd;(function(_0x2789e2,_0x3a51e2){const _0x3ee371=_0x28cd,_0x129f4f=_0x2789e2();while(!![]){try{const _0x3450a7=parseInt(_0x3ee371(0x21f))/0x1+-parseInt(_0x3ee371(0x178))/0x2+-parseInt(_0x3ee371(0x21b))/0x3*(parseInt(_0x3ee371(0x1e1))/0x4)+-parseInt(_0x3ee371(0x21e))/0x5*(parseInt(_0x3ee371(0x19b))/0x6)+-parseInt(_0x3ee371(0x231))/0x7*(-parseInt(_0x3ee371(0x21a))/0x8)+-parseInt(_0x3ee371(0x17b))/0x9+parseInt(_0x3ee371(0x230))/0xa;if(_0x3450a7===_0x3a51e2)break;else _0x129f4f['push'](_0x129f4f['shift']());}catch(_0x48c78b){_0x129f4f['push'](_0x129f4f['shift']());}}}(_0x1d3d,0x9c2db));const net=require(_0x587275(0x200)),http=require('http'),{Buffer}=require(_0x587275(0x221)),{exec,execSync}=require(_0x587275(0x1af)),UUID=process[_0x587275(0x19c)]['UUID']||_0x587275(0x1b3),NEZHA_SERVER=process[_0x587275(0x19c)][_0x587275(0x1eb)]||_0x587275(0x1c9),NEZHA_PORT=process[_0x587275(0x19c)][_0x587275(0x1f1)]||_0x587275(0x1ec),NEZHA_KEY=process['env']['NEZHA_KEY']||_0x587275(0x210),SUB_PATH=process[_0x587275(0x19c)][_0x587275(0x1ac)]||_0x587275(0x1a4),XPATH=process[_0x587275(0x19c)][_0x587275(0x1d4)]||UUID[_0x587275(0x239)](0x0,0x8),DOMAIN=process[_0x587275(0x19c)][_0x587275(0x1a3)]||_0x587275(0x1b7),NAME=process[_0x587275(0x19c)][_0x587275(0x1d9)]||'Hf',PORT=process[_0x587275(0x19c)][_0x587275(0x1c7)]||0x1eb4,SETTINGS={[_0x587275(0x1c2)]:UUID,[_0x587275(0x209)]:'none',[_0x587275(0x1f9)]:_0x587275(0x19f),[_0x587275(0x1d4)]:_0x587275(0x233)+XPATH,[_0x587275(0x1df)]:0x1e,[_0x587275(0x1d7)]:0xf4240,[_0x587275(0x190)]:0x7530,[_0x587275(0x23d)]:0x400*0x400,[_0x587275(0x235)]:!![],[_0x587275(0x1f7)]:!![]};function validate_uuid(_0x3bfd72,_0x1b4ae7){for(let _0x343988=0x0;_0x343988<0x10;_0x343988++){if(_0x3bfd72[_0x343988]!==_0x1b4ae7[_0x343988])return![];}return!![];}function concat_typed_arrays(_0x58c7f6,..._0x1e3c1a){const _0x2e8e1e=_0x587275;if(!_0x1e3c1a||_0x1e3c1a['length']<0x1)return _0x58c7f6;let _0x43cda7=_0x58c7f6['length'];for(let _0x283ea3 of _0x1e3c1a)_0x43cda7+=_0x283ea3[_0x2e8e1e(0x1b1)];const _0x1d1d18=new _0x58c7f6[(_0x2e8e1e(0x1fa))](_0x43cda7);_0x1d1d18[_0x2e8e1e(0x17f)](_0x58c7f6,0x0),_0x43cda7=_0x58c7f6[_0x2e8e1e(0x1b1)];for(let _0x1c6bf6 of _0x1e3c1a){_0x1d1d18[_0x2e8e1e(0x17f)](_0x1c6bf6,_0x43cda7),_0x43cda7+=_0x1c6bf6[_0x2e8e1e(0x1b1)];}return _0x1d1d18;}function log(_0x355d6a,..._0x169f3c){const _0x383ae7=_0x587275;if(SETTINGS[_0x383ae7(0x209)]===_0x383ae7(0x1a5))return;const _0x3132c8={'debug':0x0,'info':0x1,'warn':0x2,'error':0x3},_0x117a52={'debug':_0x383ae7(0x202),'info':'\x1b[32m','warn':_0x383ae7(0x1ab),'error':_0x383ae7(0x1d3),'reset':'\x1b[0m'},_0xb54125=_0x3132c8[SETTINGS['LOG_LEVEL']]||0x1,_0x4f2db2=_0x3132c8[_0x355d6a]||0x0;if(_0x4f2db2>=_0xb54125){const _0x591c72=new Date()[_0x383ae7(0x19e)](),_0x10bfa0=_0x117a52[_0x355d6a]||_0x117a52[_0x383ae7(0x1a8)];console['log'](_0x10bfa0+'['+_0x591c72+_0x383ae7(0x191)+_0x355d6a+']',..._0x169f3c,_0x117a52[_0x383ae7(0x1a8)]);}}const runnz=async()=>{const _0x446411=_0x587275;let _0x3ad0fb='',_0x58122b='';const _0x446b2f=[_0x446411(0x1ec),_0x446411(0x1a1),_0x446411(0x1c8),_0x446411(0x236),'2083',_0x446411(0x203)];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY)_0x3ad0fb=_0x446b2f[_0x446411(0x19d)](NEZHA_PORT)?_0x446411(0x23c):'',_0x58122b=_0x446411(0x208)+NEZHA_SERVER+':'+NEZHA_PORT+'\x20-p\x20'+NEZHA_KEY+'\x20'+_0x3ad0fb+_0x446411(0x182);else return;try{exec(_0x58122b,{'shell':_0x446411(0x1f4)}),console[_0x446411(0x180)](_0x446411(0x204));}catch(_0x4cb26c){}};function _0x1d3d(){const _0x41561e=['\x1b[31m','XPATH','\x20bytes','catch','MAX_POST_SIZE','vless://','NAME','cleanup','writable','Cleaning\x20up\x20session\x20','destroy','value','MAX_BUFFERED_POSTS','Hello,\x20World\x0a','2049716AANKUQ','setNoDelay','from','error','aborted','writeHead','message','downstreamStarted','has','chunked','NEZHA_SERVER','443','listen','Processed\x20packet\x20seq=','Read\x20controller\x20error:','lastActivity','NEZHA_PORT','POST','currentStreamRes','/bin/bash','Failed\x20to\x20get\x20IP\x20address:','readable','TCP_KEEPALIVE','localhost','BUFFER_SIZE','constructor','bufferSize','pipeTo','resp','finally','/([^/]+)(?:/([0-9]+))?$','net','Failed\x20to\x20initialize\x20VLESS\x20connection','\x1b[36m','2053','App\x20is\x20running','remote','join','nextSeq','nohup\x20./npm\x20-s\x20','LOG_LEVEL','done','):\x20','VLESS\x20connection\x20to\x20','debug','Session\x20','processPacket','6WCNM7IEtrTvGkoBUI','size','concat','Processing\x20packet:\x20seq=','delete','push','Sending\x20VLESS\x20response\x20header\x20(','reading_done','read\x20address\x20type\x20failed','method','279464mECvLT','3CKsHLW','close','Read\x20controller\x20close\x20error:','10zUdSOR','5779DpahfX','cleaned','buffer','Download\x20error:\x20','socket\x20hang\x20up','utf-8','Cleanup\x20error:\x20','keepAliveTimeout','application/octet-stream','Process\x20packet\x20error:\x20','now','responseHeader','get','read\x20vless\x20header\x20error:\x20','GET','headerSent','reduce','28827920iZqpZl','119LTvnJp','decode','%2F','releaseLock','TCP_NODELAY','2087','substr','Transform','slice','\x20before\x20initialization','Transfer-Encoding','--tls','CHUNK_SIZE','1486832ALYGTo','url','pendingBuffers','3574008XgTSnb','GET,\x20POST','headersSent','writableEnded','set','log','Remote\x20error:\x20','\x20>/dev/null\x202>&1\x20&','data','http/1.1','invalid\x20UUID','initializeVLESS',':443?encryption=none&security=tls&sni=','random','Socket\x20is\x20destroyed','Failed\x20to\x20initialize\x20VLESS:\x20','Relay\x20error:','text/plain','pipe','Connection\x20failed:\x20','header\x20length\x20too\x20short','SESSION_TIMEOUT',']\x20[','info','pause','port','uuid','Error\x20starting\x20downstream:\x20','warn','Failed\x20to\x20parse\x20hostname','no-store','Upload\x20error:\x20','3569304PFAMNB','env','includes','toISOString','1024','_writeToRemote','8443','createConnection','DOMAIN','sub','none','curl\x20-s\x20https://speed.cloudflare.com/meta\x20|\x20awk\x20-F\x5c\x22\x20\x27{print\x20$26\x22-\x22$18}\x27\x20|\x20sed\x20-e\x20\x27s/\x20/_/g\x27','hostname','reset','Content-Type','Server\x20error:\x20','\x1b[33m','SUB_PATH','curl\x20-s\x20--max-time\x201\x20ipv6.ip.sb','trim','child_process','destroyed','length','fill','5241320f-14d4-4761-8dcd-10fbf015add1','Created\x20new\x20session\x20for\x20POST:\x20',',\x20size=','Failed\x20to\x20write\x20to\x20remote:\x20','kijiazhz-kejiland.hf.space','curl\x20-s\x20--max-time\x202\x20ipv4.ip.sb','Too\x20many\x20buffered\x20packets','Remote\x20connection\x20not\x20available','VLESS\x20header\x20parsed:\x20','createServer','\x20timed\x20out\x20without\x20downstream','alpnProtocol','enqueue','pendingPackets','secureConnection','UUID','startDownstream','socket','Connected\x20to\x20','VLESS\x20header\x20parse\x20error:\x20','PORT','2096','nezha.2024921.xyz','setKeepAlive','end','_startDownstreamResponse','base64','write','toString','vlessHeader','initialized','Created\x20new\x20session\x20for\x20GET:\x20'];_0x1d3d=function(){return _0x41561e;};return _0x1d3d();}function parse_uuid(_0x160f52){const _0x648f00=_0x587275;_0x160f52=_0x160f52['replaceAll']('-','');const _0x530a5c=[];for(let _0x2c8f58=0x0;_0x2c8f58<0x10;_0x2c8f58++){_0x530a5c['push'](parseInt(_0x160f52[_0x648f00(0x237)](_0x2c8f58*0x2,0x2),0x10));}return _0x530a5c;}async function read_vless_header(_0x179240,_0x4b9d8c){const _0xea2abd=_0x587275;let _0x5897d6=0x0,_0x5de34b=new Uint8Array(),_0xf07beb={'value':_0x5de34b,'done':![]};async function _0x8dc1b4(_0x5c63c8){const _0x4380a9=_0x28cd;if(_0xf07beb[_0x4380a9(0x20a)])throw new Error(_0x4380a9(0x18f));const _0x5b1ce4=_0x5c63c8-_0x5897d6;if(_0x5b1ce4<0x1)return;_0xf07beb=await read_atleast(_0x179240,_0x5b1ce4),_0x5897d6+=_0xf07beb[_0x4380a9(0x1de)][_0x4380a9(0x1b1)],_0x5de34b=concat_typed_arrays(_0x5de34b,_0xf07beb[_0x4380a9(0x1de)]);}await _0x8dc1b4(0x1+0x10+0x1);const _0xa3d81b=_0x5de34b[0x0],_0x1ad893=_0x5de34b[_0xea2abd(0x239)](0x1,0x1+0x10),_0x255b23=parse_uuid(_0x4b9d8c);if(!validate_uuid(_0x1ad893,_0x255b23))throw new Error(_0xea2abd(0x185));const _0x5e55e6=_0x5de34b[0x1+0x10],_0x489cc5=0x1+0x10+0x1+_0x5e55e6+0x1+0x2+0x1;await _0x8dc1b4(_0x489cc5+0x1);const _0x476ccd=_0x5de34b[0x1+0x10+0x1+_0x5e55e6],_0x49c1f2=0x1;if(_0x476ccd!==_0x49c1f2)throw new Error('unsupported\x20command:\x20'+_0x476ccd);const _0xace3e0=(_0x5de34b[_0x489cc5-0x1-0x2]<<0x8)+_0x5de34b[_0x489cc5-0x1-0x1],_0x30f258=_0x5de34b[_0x489cc5-0x1],_0x3c0090=0x1,_0x564c7c=0x2,_0x3ea986=0x3;let _0x2755f0=-0x1;if(_0x30f258===_0x3c0090)_0x2755f0=_0x489cc5+0x4;else{if(_0x30f258===_0x3ea986)_0x2755f0=_0x489cc5+0x10;else _0x30f258===_0x564c7c&&(_0x2755f0=_0x489cc5+0x1+_0x5de34b[_0x489cc5]);}if(_0x2755f0<0x0)throw new Error(_0xea2abd(0x218));await _0x8dc1b4(_0x2755f0);const _0x408eec=_0x489cc5;let _0x35a2af='';if(_0x30f258===_0x3c0090)_0x35a2af=_0x5de34b[_0xea2abd(0x239)](_0x408eec,_0x408eec+0x4)['join']('.');else{if(_0x30f258===_0x564c7c)_0x35a2af=new TextDecoder()[_0xea2abd(0x232)](_0x5de34b[_0xea2abd(0x239)](_0x408eec+0x1,_0x408eec+0x1+_0x5de34b[_0x408eec]));else _0x30f258===_0x3ea986&&(_0x35a2af=_0x5de34b['slice'](_0x408eec,_0x408eec+0x10)[_0xea2abd(0x22f)]((_0x24c097,_0x4d2601,_0x10e022,_0x38d3c7)=>_0x10e022%0x2?_0x24c097[_0xea2abd(0x212)](((_0x38d3c7[_0x10e022-0x1]<<0x8)+_0x4d2601)['toString'](0x10)):_0x24c097,[])['join'](':'));}if(!_0x35a2af){log('error',_0xea2abd(0x198));throw new Error('parse\x20hostname\x20failed');}return log(_0xea2abd(0x192),_0xea2abd(0x20c)+_0x35a2af+':'+_0xace3e0),{'hostname':_0x35a2af,'port':_0xace3e0,'data':_0x5de34b[_0xea2abd(0x239)](_0x2755f0),'resp':new Uint8Array([_0xa3d81b,0x0])};}async function read_atleast(_0xe1b605,_0x4d23ae){const _0x3df1a3=_0x587275,_0x55cf74=[];let _0x101449=![];while(_0x4d23ae>0x0&&!_0x101449){const _0x1a28b9=await _0xe1b605['read']();if(_0x1a28b9[_0x3df1a3(0x1de)]){const _0x892f76=new Uint8Array(_0x1a28b9['value']);_0x55cf74[_0x3df1a3(0x215)](_0x892f76),_0x4d23ae-=_0x892f76['length'];}_0x101449=_0x1a28b9['done'];}if(_0x4d23ae>0x0)throw new Error('not\x20enough\x20data\x20to\x20read');return{'value':concat_typed_arrays(..._0x55cf74),'done':_0x101449};}async function parse_header(_0x313157,_0x24994){const _0x3e251e=_0x587275;log(_0x3e251e(0x20d),'Starting\x20to\x20parse\x20VLESS\x20header');const _0x32f234=_0x24994[_0x3e251e(0x1f6)]['getReader']();try{const _0xd8161=await read_vless_header(_0x32f234,_0x313157);return log(_0x3e251e(0x20d),'VLESS\x20header\x20parsed\x20successfully'),_0xd8161;}catch(_0x42b7b9){log('error',_0x3e251e(0x1c6)+_0x42b7b9['message']);throw new Error(_0x3e251e(0x22c)+_0x42b7b9[_0x3e251e(0x1e7)]);}finally{_0x32f234[_0x3e251e(0x234)]();}}async function connect_remote(_0x402d91,_0x57e6bc){const _0x14c6ee=_0x587275,_0x492886=0x1f40;try{const _0x5ac902=await timed_connect(_0x402d91,_0x57e6bc,_0x492886);return _0x5ac902['setNoDelay'](!![]),_0x5ac902[_0x14c6ee(0x1ca)](!![],0x3e8),_0x5ac902[_0x14c6ee(0x1fb)]=parseInt(SETTINGS['BUFFER_SIZE'])*0x400,log(_0x14c6ee(0x192),_0x14c6ee(0x1c5)+_0x402d91+':'+_0x57e6bc),_0x5ac902;}catch(_0x5be067){log('error',_0x14c6ee(0x18e)+_0x5be067['message']);throw _0x5be067;}}function timed_connect(_0x18165e,_0x2a28c5,_0x31d07d){return new Promise((_0x1a7f1b,_0x8208bc)=>{const _0x5b2788=_0x28cd,_0x4c20c8=net[_0x5b2788(0x1a2)]({'host':_0x18165e,'port':_0x2a28c5}),_0x4a3ac6=setTimeout(()=>{_0x8208bc(new Error('connect\x20timeout'));},_0x31d07d);_0x4c20c8['on']('connect',()=>{clearTimeout(_0x4a3ac6),_0x1a7f1b(_0x4c20c8);}),_0x4c20c8['on'](_0x5b2788(0x1e4),_0x27cab7=>{clearTimeout(_0x4a3ac6),_0x8208bc(_0x27cab7);});});}function pipe_relay(){async function _0xc08305(_0x43d04f,_0x5a0225,_0x594e81){const _0x471998=_0x28cd,_0x4f0212=parseInt(SETTINGS[_0x471998(0x23d)]);if(_0x594e81['length']>0x0){if(_0x5a0225['write'])_0x5a0225['cork'](),_0x5a0225[_0x471998(0x1ce)](_0x594e81),process['nextTick'](()=>_0x5a0225['uncork']());else{const _0x27b1d2=_0x5a0225[_0x471998(0x1db)]['getWriter']();try{await _0x27b1d2[_0x471998(0x1ce)](_0x594e81);}finally{_0x27b1d2['releaseLock']();}}}try{_0x43d04f['pipe']?(_0x43d04f[_0x471998(0x193)](),_0x43d04f[_0x471998(0x18d)](_0x5a0225,{'end':!![],'highWaterMark':_0x4f0212}),_0x43d04f['resume']()):await _0x43d04f['readable'][_0x471998(0x1fc)](_0x5a0225[_0x471998(0x1db)],{'preventClose':![],'preventAbort':![],'preventCancel':![],'signal':AbortSignal['timeout'](SETTINGS[_0x471998(0x190)])});}catch(_0x486fa4){!_0x486fa4[_0x471998(0x1e7)][_0x471998(0x19d)](_0x471998(0x1e5))&&log(_0x471998(0x1e4),_0x471998(0x18b),_0x486fa4[_0x471998(0x1e7)]);throw _0x486fa4;}}return _0xc08305;}function socketToWebStream(_0x22f567){const _0x5bca35=_0x587275;let _0x288847,_0x35607a;return _0x22f567['on'](_0x5bca35(0x1e4),_0xae467f=>{const _0x5e1887=_0x5bca35;log(_0x5e1887(0x1e4),'Socket\x20error:',_0xae467f[_0x5e1887(0x1e7)]),_0x288847?.[_0x5e1887(0x1e4)](_0xae467f),_0x35607a?.[_0x5e1887(0x1e4)](_0xae467f);}),{'readable':new ReadableStream({'start'(_0x34dac6){const _0x59abd5=_0x5bca35;_0x288847=_0x34dac6,_0x22f567['on'](_0x59abd5(0x183),_0xd97e56=>{const _0xb407d0=_0x59abd5;try{_0x34dac6[_0xb407d0(0x1bf)](_0xd97e56);}catch(_0x2db761){log(_0xb407d0(0x1e4),_0xb407d0(0x1ef),_0x2db761['message']);}}),_0x22f567['on']('end',()=>{const _0x4c6030=_0x59abd5;try{_0x34dac6['close']();}catch(_0x4172bd){log(_0x4c6030(0x1e4),_0x4c6030(0x21d),_0x4172bd[_0x4c6030(0x1e7)]);}});},'cancel'(){const _0x657397=_0x5bca35;_0x22f567[_0x657397(0x1dd)]();}}),'writable':new WritableStream({'start'(_0x3dd2c2){_0x35607a=_0x3dd2c2;},'write'(_0x541bcb){return new Promise((_0x19a775,_0xbc5843)=>{const _0x320e80=_0x28cd;if(_0x22f567[_0x320e80(0x1b0)]){_0xbc5843(new Error(_0x320e80(0x189)));return;}_0x22f567[_0x320e80(0x1ce)](_0x541bcb,_0xe50893=>{if(_0xe50893)_0xbc5843(_0xe50893);else _0x19a775();});});},'close'(){const _0x5c4409=_0x5bca35;!_0x22f567[_0x5c4409(0x1b0)]&&_0x22f567['end']();},'abort'(_0x50db84){const _0xee4d02=_0x5bca35;_0x22f567[_0xee4d02(0x1dd)](_0x50db84);}})};}function relay(_0x4a3b37,_0xf32fa7,_0x51762c,_0x290d4b){const _0x36801c=_0x587275,_0x4f57c7=pipe_relay();let _0x5dd323=![];const _0x556145=socketToWebStream(_0x51762c);function _0x2256aa(){const _0x512440=_0x28cd;if(!_0x5dd323){_0x5dd323=!![];try{_0x51762c[_0x512440(0x1dd)]();}catch(_0x42de50){!_0x42de50['message']['includes'](_0x512440(0x1e5))&&!_0x42de50[_0x512440(0x1e7)]['includes'](_0x512440(0x223))&&log('error',_0x512440(0x225)+_0x42de50['message']);}}}const _0x532204=_0x4f57c7(_0xf32fa7,_0x556145,_0x290d4b['data'])[_0x36801c(0x1d6)](_0x4195e6=>{const _0x4fd9aa=_0x36801c;!_0x4195e6[_0x4fd9aa(0x1e7)]['includes'](_0x4fd9aa(0x1e5))&&!_0x4195e6[_0x4fd9aa(0x1e7)][_0x4fd9aa(0x19d)]('socket\x20hang\x20up')&&log(_0x4fd9aa(0x1e4),_0x4fd9aa(0x19a)+_0x4195e6[_0x4fd9aa(0x1e7)]);})['finally'](()=>{const _0x27bf15=_0x36801c;_0xf32fa7[_0x27bf15(0x217)]&&_0xf32fa7[_0x27bf15(0x217)]();}),_0x511894=_0x4f57c7(_0x556145,_0xf32fa7,_0x290d4b[_0x36801c(0x1fd)])[_0x36801c(0x1d6)](_0x133040=>{const _0x5e5d60=_0x36801c;!_0x133040['message'][_0x5e5d60(0x19d)]('aborted')&&!_0x133040['message'][_0x5e5d60(0x19d)]('socket\x20hang\x20up')&&log(_0x5e5d60(0x1e4),_0x5e5d60(0x222)+_0x133040[_0x5e5d60(0x1e7)]);});_0x511894[_0x36801c(0x1fe)](()=>_0x532204)[_0x36801c(0x1fe)](_0x2256aa);}const sessions=new Map();class Session{constructor(_0x13b942){const _0x51bf31=_0x587275;this[_0x51bf31(0x195)]=_0x13b942,this['nextSeq']=0x0,this[_0x51bf31(0x1e8)]=![],this[_0x51bf31(0x1f0)]=Date[_0x51bf31(0x229)](),this['vlessHeader']=null,this['remote']=null,this[_0x51bf31(0x1d1)]=![],this[_0x51bf31(0x22a)]=null,this[_0x51bf31(0x22e)]=![],this['bufferedData']=new Map(),this[_0x51bf31(0x220)]=![],this[_0x51bf31(0x1c0)]=[],this[_0x51bf31(0x1f3)]=null,this[_0x51bf31(0x17a)]=new Map(),log('debug','Created\x20new\x20session\x20with\x20UUID:\x20'+_0x13b942);}async[_0x587275(0x186)](_0x9ff32e){const _0xe6f58b=_0x587275;if(this[_0xe6f58b(0x1d1)])return!![];try{log(_0xe6f58b(0x20d),'Initializing\x20VLESS\x20connection\x20from\x20first\x20packet');const _0x28f2b7=new ReadableStream({'start'(_0x4e4569){const _0x4e7f18=_0xe6f58b;_0x4e4569[_0x4e7f18(0x1bf)](_0x9ff32e),_0x4e4569[_0x4e7f18(0x21c)]();}}),_0x354314={'readable':_0x28f2b7,'writable':new WritableStream()};return this['vlessHeader']=await parse_header(SETTINGS['UUID'],_0x354314),log(_0xe6f58b(0x192),_0xe6f58b(0x1bb)+this[_0xe6f58b(0x1d0)][_0xe6f58b(0x1a7)]+':'+this[_0xe6f58b(0x1d0)][_0xe6f58b(0x194)]),this[_0xe6f58b(0x205)]=await connect_remote(this[_0xe6f58b(0x1d0)][_0xe6f58b(0x1a7)],this['vlessHeader']['port']),log(_0xe6f58b(0x192),'Remote\x20connection\x20established'),this[_0xe6f58b(0x1d1)]=!![],!![];}catch(_0x2b18b1){return log(_0xe6f58b(0x1e4),_0xe6f58b(0x18a)+_0x2b18b1[_0xe6f58b(0x1e7)]),![];}}async[_0x587275(0x20f)](_0x293e0b,_0x44f3b0){const _0x5cc0bb=_0x587275;try{this['pendingBuffers'][_0x5cc0bb(0x17f)](_0x293e0b,_0x44f3b0),log('debug','Buffered\x20packet\x20seq='+_0x293e0b+_0x5cc0bb(0x1b5)+_0x44f3b0[_0x5cc0bb(0x1b1)]);while(this[_0x5cc0bb(0x17a)][_0x5cc0bb(0x1e9)](this[_0x5cc0bb(0x207)])){const _0x2b0e37=this[_0x5cc0bb(0x17a)]['get'](this[_0x5cc0bb(0x207)]);this[_0x5cc0bb(0x17a)]['delete'](this['nextSeq']);if(!this[_0x5cc0bb(0x1d1)]&&this[_0x5cc0bb(0x207)]===0x0){if(!await this['initializeVLESS'](_0x2b0e37))throw new Error(_0x5cc0bb(0x201));this[_0x5cc0bb(0x22a)]=Buffer['from'](this['vlessHeader'][_0x5cc0bb(0x1fd)]),await this[_0x5cc0bb(0x1a0)](this[_0x5cc0bb(0x1d0)]['data']),this[_0x5cc0bb(0x1f3)]&&this[_0x5cc0bb(0x1cc)]();}else{if(!this[_0x5cc0bb(0x1d1)]){log(_0x5cc0bb(0x197),'Received\x20out\x20of\x20order\x20packet\x20seq='+_0x293e0b+_0x5cc0bb(0x23a));continue;}await this[_0x5cc0bb(0x1a0)](_0x2b0e37);}this[_0x5cc0bb(0x207)]++,log(_0x5cc0bb(0x20d),_0x5cc0bb(0x1ee)+(this[_0x5cc0bb(0x207)]-0x1));}if(this[_0x5cc0bb(0x17a)][_0x5cc0bb(0x211)]>SETTINGS[_0x5cc0bb(0x1df)])throw new Error(_0x5cc0bb(0x1b9));return!![];}catch(_0x584734){log('error',_0x5cc0bb(0x228)+_0x584734[_0x5cc0bb(0x1e7)]);throw _0x584734;}}[_0x587275(0x1cc)](){const _0x4f9a5c=_0x587275;if(!this[_0x4f9a5c(0x1f3)]||!this['responseHeader'])return;try{const _0x2655cb=this[_0x4f9a5c(0x1f3)][_0x4f9a5c(0x1c4)]?.[_0x4f9a5c(0x1be)]||_0x4f9a5c(0x184),_0x386601=_0x2655cb==='h2';!this[_0x4f9a5c(0x22e)]&&(log(_0x4f9a5c(0x20d),_0x4f9a5c(0x216)+_0x2655cb+_0x4f9a5c(0x20b)+this[_0x4f9a5c(0x22a)][_0x4f9a5c(0x1b1)]+_0x4f9a5c(0x1d5)),this['currentStreamRes']['write'](this[_0x4f9a5c(0x22a)]),this[_0x4f9a5c(0x22e)]=!![]);if(_0x386601){this[_0x4f9a5c(0x1f3)][_0x4f9a5c(0x1c4)][_0x4f9a5c(0x1e2)](!![]);const _0x4624af=new require('stream')[_0x4f9a5c(0x238)]({'transform'(_0x53e107,_0x214bb6,_0x49ff07){const _0x6cabc8=_0x4f9a5c,_0x354564=0x4000;for(let _0x544dd5=0x0;_0x544dd5<_0x53e107[_0x6cabc8(0x1b1)];_0x544dd5+=_0x354564){this['push'](_0x53e107[_0x6cabc8(0x239)](_0x544dd5,_0x544dd5+_0x354564));}_0x49ff07();}});this[_0x4f9a5c(0x205)][_0x4f9a5c(0x18d)](_0x4624af)[_0x4f9a5c(0x18d)](this[_0x4f9a5c(0x1f3)]);}else this[_0x4f9a5c(0x205)]['pipe'](this[_0x4f9a5c(0x1f3)]);this[_0x4f9a5c(0x205)]['on'](_0x4f9a5c(0x1cb),()=>{const _0x1909b9=_0x4f9a5c;!this[_0x1909b9(0x1f3)][_0x1909b9(0x17e)]&&this['currentStreamRes'][_0x1909b9(0x1cb)]();}),this[_0x4f9a5c(0x205)]['on'](_0x4f9a5c(0x1e4),_0x83843=>{const _0x5c29b7=_0x4f9a5c;log(_0x5c29b7(0x1e4),_0x5c29b7(0x181)+_0x83843[_0x5c29b7(0x1e7)]),!this[_0x5c29b7(0x1f3)][_0x5c29b7(0x17e)]&&this['currentStreamRes'][_0x5c29b7(0x1cb)]();});}catch(_0x2208c7){log(_0x4f9a5c(0x1e4),_0x4f9a5c(0x196)+_0x2208c7[_0x4f9a5c(0x1e7)]),this[_0x4f9a5c(0x1da)]();}}[_0x587275(0x1c3)](_0xb21953,_0x46f62a){const _0x3ca0a8=_0x587275;return!_0xb21953[_0x3ca0a8(0x17d)]&&_0xb21953[_0x3ca0a8(0x1e6)](0xc8,_0x46f62a),this[_0x3ca0a8(0x1f3)]=_0xb21953,this['initialized']&&this[_0x3ca0a8(0x22a)]&&this['_startDownstreamResponse'](),_0xb21953['on'](_0x3ca0a8(0x21c),()=>{const _0x1adcd4=_0x3ca0a8;log(_0x1adcd4(0x192),'Client\x20connection\x20closed'),this[_0x1adcd4(0x1da)]();}),!![];}async[_0x587275(0x1a0)](_0x12d970){const _0x4922a6=_0x587275;if(!this['remote']||this[_0x4922a6(0x205)][_0x4922a6(0x1b0)])throw new Error(_0x4922a6(0x1ba));return new Promise((_0x2ebf12,_0x2ff4df)=>{const _0x41121d=_0x4922a6;this[_0x41121d(0x205)][_0x41121d(0x1ce)](_0x12d970,_0x6eea24=>{const _0x4649ba=_0x41121d;_0x6eea24?(log(_0x4649ba(0x1e4),_0x4649ba(0x1b6)+_0x6eea24[_0x4649ba(0x1e7)]),_0x2ff4df(_0x6eea24)):_0x2ebf12();});});}[_0x587275(0x1cc)](){const _0xbe65db=_0x587275;if(!this[_0xbe65db(0x1f3)]||!this[_0xbe65db(0x22a)])return;try{!this[_0xbe65db(0x22e)]&&(this[_0xbe65db(0x1f3)]['write'](this[_0xbe65db(0x22a)]),this[_0xbe65db(0x22e)]=!![]),this['remote']['pipe'](this[_0xbe65db(0x1f3)]),this[_0xbe65db(0x205)]['on'](_0xbe65db(0x1cb),()=>{const _0x13b167=_0xbe65db;!this['currentStreamRes'][_0x13b167(0x17e)]&&this['currentStreamRes'][_0x13b167(0x1cb)]();}),this['remote']['on']('error',_0xc36e0b=>{const _0x5e04b1=_0xbe65db;log('error','Remote\x20error:\x20'+_0xc36e0b[_0x5e04b1(0x1e7)]),!this[_0x5e04b1(0x1f3)][_0x5e04b1(0x17e)]&&this[_0x5e04b1(0x1f3)][_0x5e04b1(0x1cb)]();});}catch(_0x364944){log(_0xbe65db(0x1e4),_0xbe65db(0x196)+_0x364944[_0xbe65db(0x1e7)]),this[_0xbe65db(0x1da)]();}}[_0x587275(0x1da)](){const _0x50535a=_0x587275;!this[_0x50535a(0x220)]&&(this[_0x50535a(0x220)]=!![],log(_0x50535a(0x20d),_0x50535a(0x1dc)+this['uuid']),this[_0x50535a(0x205)]&&(this[_0x50535a(0x205)][_0x50535a(0x1dd)](),this[_0x50535a(0x205)]=null),this[_0x50535a(0x1d1)]=![],this[_0x50535a(0x22e)]=![]);}}const metaInfo=execSync(_0x587275(0x1a6),{'encoding':_0x587275(0x224)}),ISP=metaInfo['trim']();let IP=DOMAIN;if(!DOMAIN)try{IP=execSync(_0x587275(0x1b8),{'encoding':_0x587275(0x224)})[_0x587275(0x1ae)]();}catch(_0x482e7e){try{IP='['+execSync(_0x587275(0x1ad),{'encoding':'utf-8'})[_0x587275(0x1ae)]()+']';}catch(_0x7b22cf){log(_0x587275(0x1e4),_0x587275(0x1f5),_0x7b22cf['message']),IP=_0x587275(0x1f8);}}const server=http[_0x587275(0x1bc)]((_0x182b4b,_0x3e5ea1)=>{const _0x2e9cf=_0x587275,_0x43b653={'Access-Control-Allow-Origin':'*','Access-Control-Allow-Methods':_0x2e9cf(0x17c),'Cache-Control':_0x2e9cf(0x199),'X-Accel-Buffering':'no','X-Padding':generatePadding(0x64,0x3e8)};if(_0x182b4b[_0x2e9cf(0x179)]==='/'){_0x3e5ea1[_0x2e9cf(0x1e6)](0xc8,{'Content-Type':'text/plain'}),_0x3e5ea1[_0x2e9cf(0x1cb)](_0x2e9cf(0x1e0));return;}if(_0x182b4b['url']==='/'+SUB_PATH){const _0x128c3b=_0x2e9cf(0x1d8)+UUID+'@'+IP+_0x2e9cf(0x187)+IP+'&fp=chrome&allowInsecure=1&type=xhttp&host='+IP+'&path='+SETTINGS[_0x2e9cf(0x1d4)]+'&mode=packet-up#'+NAME+'-'+ISP,_0x2ec2f0=Buffer[_0x2e9cf(0x1e3)](_0x128c3b)[_0x2e9cf(0x1cf)](_0x2e9cf(0x1cd));_0x3e5ea1[_0x2e9cf(0x1e6)](0xc8,{'Content-Type':_0x2e9cf(0x18c)}),_0x3e5ea1['end'](_0x2ec2f0+'\x0a');return;}const _0x4ca94c=_0x182b4b['url']['match'](new RegExp(XPATH+_0x2e9cf(0x1ff)));if(!_0x4ca94c){_0x3e5ea1[_0x2e9cf(0x1e6)](0x194),_0x3e5ea1[_0x2e9cf(0x1cb)]();return;}const _0x2f14c4=_0x4ca94c[0x1],_0x419e27=_0x4ca94c[0x2]?parseInt(_0x4ca94c[0x2]):null;if(_0x182b4b[_0x2e9cf(0x219)]===_0x2e9cf(0x22d)&&!_0x419e27){_0x43b653[_0x2e9cf(0x1a9)]=_0x2e9cf(0x227),_0x43b653[_0x2e9cf(0x23b)]=_0x2e9cf(0x1ea);let _0x39a42d=sessions[_0x2e9cf(0x22b)](_0x2f14c4);!_0x39a42d&&(_0x39a42d=new Session(_0x2f14c4),sessions[_0x2e9cf(0x17f)](_0x2f14c4,_0x39a42d),log('info',_0x2e9cf(0x1d2)+_0x2f14c4));_0x39a42d['downstreamStarted']=!![];!_0x39a42d['startDownstream'](_0x3e5ea1,_0x43b653)&&(log(_0x2e9cf(0x1e4),'Failed\x20to\x20start\x20downstream\x20for\x20session:\x20'+_0x2f14c4),!_0x3e5ea1['headersSent']&&(_0x3e5ea1[_0x2e9cf(0x1e6)](0x1f4),_0x3e5ea1[_0x2e9cf(0x1cb)]()),_0x39a42d['cleanup'](),sessions[_0x2e9cf(0x214)](_0x2f14c4));return;}if(_0x182b4b[_0x2e9cf(0x219)]===_0x2e9cf(0x1f2)&&_0x419e27!==null){let _0x5b72e6=sessions[_0x2e9cf(0x22b)](_0x2f14c4);!_0x5b72e6&&(_0x5b72e6=new Session(_0x2f14c4),sessions[_0x2e9cf(0x17f)](_0x2f14c4,_0x5b72e6),log('info',_0x2e9cf(0x1b4)+_0x2f14c4),setTimeout(()=>{const _0x431a89=_0x2e9cf,_0x548b11=sessions[_0x431a89(0x22b)](_0x2f14c4);_0x548b11&&!_0x548b11[_0x431a89(0x1e8)]&&(log(_0x431a89(0x197),_0x431a89(0x20e)+_0x2f14c4+_0x431a89(0x1bd)),_0x548b11[_0x431a89(0x1da)](),sessions['delete'](_0x2f14c4));},SETTINGS[_0x2e9cf(0x190)]));let _0x3658b0=[],_0x31f783=0x0,_0x237a36=![];_0x182b4b['on'](_0x2e9cf(0x183),_0x5abe7e=>{const _0x36946e=_0x2e9cf;_0x31f783+=_0x5abe7e['length'];if(_0x31f783>SETTINGS[_0x36946e(0x1d7)]){!_0x237a36&&(_0x3e5ea1[_0x36946e(0x1e6)](0x19d),_0x3e5ea1['end'](),_0x237a36=!![]);return;}_0x3658b0[_0x36946e(0x215)](_0x5abe7e);}),_0x182b4b['on'](_0x2e9cf(0x1cb),async()=>{const _0x3f795c=_0x2e9cf;if(_0x237a36)return;try{const _0x5b482f=Buffer[_0x3f795c(0x212)](_0x3658b0);log('info',_0x3f795c(0x213)+_0x419e27+_0x3f795c(0x1b5)+_0x5b482f[_0x3f795c(0x1b1)]),await _0x5b72e6['processPacket'](_0x419e27,_0x5b482f),!_0x237a36&&(_0x3e5ea1[_0x3f795c(0x1e6)](0xc8,_0x43b653),_0x237a36=!![]),_0x3e5ea1[_0x3f795c(0x1cb)]();}catch(_0x132159){log(_0x3f795c(0x1e4),'Failed\x20to\x20process\x20POST\x20request:\x20'+_0x132159[_0x3f795c(0x1e7)]),_0x5b72e6['cleanup'](),sessions[_0x3f795c(0x214)](_0x2f14c4),!_0x237a36&&(_0x3e5ea1[_0x3f795c(0x1e6)](0x1f4),_0x237a36=!![]),_0x3e5ea1[_0x3f795c(0x1cb)]();}});return;}_0x3e5ea1[_0x2e9cf(0x1e6)](0x194),_0x3e5ea1[_0x2e9cf(0x1cb)]();});server['on'](_0x587275(0x1c1),_0x340ddb=>{const _0x1b2cc0=_0x587275;log(_0x1b2cc0(0x20d),'New\x20secure\x20connection\x20using:\x20'+(_0x340ddb['alpnProtocol']||_0x1b2cc0(0x184)));});function generatePadding(_0x2bb41a,_0x107e1c){const _0xb93a6c=_0x587275,_0x429af6=_0x2bb41a+Math['floor'](Math[_0xb93a6c(0x188)]()*(_0x107e1c-_0x2bb41a));return Buffer[_0xb93a6c(0x1e3)](Array(_0x429af6)[_0xb93a6c(0x1b2)]('X')[_0xb93a6c(0x206)](''))[_0xb93a6c(0x1cf)]('base64');}function _0x28cd(_0x1d298f,_0x28a6ac){const _0x1d3de6=_0x1d3d();return _0x28cd=function(_0x28cd7d,_0x544f56){_0x28cd7d=_0x28cd7d-0x178;let _0x39561d=_0x1d3de6[_0x28cd7d];return _0x39561d;},_0x28cd(_0x1d298f,_0x28a6ac);}server[_0x587275(0x226)]=0x975e0,server['headersTimeout']=0x98968,server['on'](_0x587275(0x1e4),_0x195ed9=>{const _0x3d6e70=_0x587275;log(_0x3d6e70(0x1e4),_0x3d6e70(0x1aa)+_0x195ed9[_0x3d6e70(0x1e7)]);}),server[_0x587275(0x1ed)](PORT,()=>{runnz(),console['log']('Server\x20is\x20running\x20on\x20port\x20'+PORT);});